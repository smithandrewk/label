{% extends "base.html" %}

{% block title %}Dashboard - Accelerometer Data Visualization{% endblock %}

{% block content %}
<!-- Table View -->
<div id="table-view">
    <!-- Project Level Section -->
    <div class="card mb-4">
        <div class="card-body py-2">
            <div class="d-flex align-items-center">
                <span class="text-muted me-3 fw-medium">Project Status:</span>
                <span id="verification-percentage-pill" class="badge fs-6 bg-secondary">Project 0% Verified</span>
            </div>
        </div>
    </div>
    
    <!-- Sessions Table -->
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>Session Name</th>
                    <th>Project</th>
                    <th>Status</th>
                    <th>Verified</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="sessions-table-body">
                <!-- Populated by JavaScript -->
            </tbody>
        </table>
    </div>
</div>

<style>
/* Override the #table-view styling to separate project details from sessions table */
#table-view {
    background-color: transparent !important;
    border: none !important;
    border-radius: 0 !important;
    margin: 20px !important;
    overflow: visible !important;
}

/* Add border back to just the sessions table */
.table-container {
    background-color: #ffffff;
    border: 1px solid #d1d9e0;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.table-container .table {
    margin-bottom: 0;
    border: none;
}
</style>

<!-- Visualization View -->
<div id="visualization-view">
    <div class="visualization-container">
        <span id="back-btn-overlay" class="control-btn">
            <i id="back-btn-icon" class="fa-solid fa-arrow-left"></i>
        </span>

        <h2 id="visualization-title">Accelerometer Data Visualization</h2>
        <div id="action-buttons" class="mb-3">
            <!-- Dynamic buttons based on status -->
        </div>
    </div>
    <!-- Plot Container -->
    <div class="plot-container">
        <div id="timeSeriesPlot"></div>
    </div>
</div>
<div class="modal fade" id="labelingModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="modal-title">
                    <i class="fa-solid fa-tags me-2"></i>
                    Labeling Management
                </h6>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Available Labelings Section -->
                <div>
                    <h6 class="text-muted mb-2">Available Labelings</h6>
                    <div id="available-labelings-list">
                        <div class="d-flex gap-2 mb-2">
                            <i class="fa-solid fa-plus" title="Create new labeling"></i>
                            <i class="fa-solid fa-upload" id="import-labeling-btn" title="Import labeling from JSON"></i>
                        </div>
                        <!-- Populated by JavaScript -->
                    </div>
                    <!-- Hidden file input for import -->
                    <input type="file" id="import-labeling-file" accept=".json" style="display: none;">
                </div>

                <div class="mt-3">
                    <small class="text-muted">
                        <i class="fa-solid fa-keyboard me-1"></i>
                        Press R to create bout for the current labeling
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block modals %}
<!-- Additional modals specific to this page can go here -->
{% endblock %}

{% block scripts %}
<!-- Plotly for visualizations -->
<script src="https://cdn.plot.ly/plotly-2.29.1.min.js"></script>

<!-- Page-specific JS -->
<script type="module" src="/static/script.js"></script>
<script type="module" src="/static/js/pages/sessions.js"></script>

{% endblock %}